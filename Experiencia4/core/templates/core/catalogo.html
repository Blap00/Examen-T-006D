<!doctype html>
<html lang="es">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- CSS Personalizado -->
    {% load static %}
    <link rel="stylesheet" href="{% static 'core/css/style.css'%}">
    <link rel="icon" href="{% static 'core/img/logo3.png'%}">
    <title>Little pets shop || catalogo</title>
  </head>

   <!-- Comienzo del body -->
   <body class="d-flex flex-column min-vh-100" style="background-color:#fffcf8">
    <!-- Barra de navegacion superior -->
    <nav class="navbar navbar-expand-lg navbar-light sticky-top " style="background-color: #5495ca;">
      <div class="container-fluid">
        <img src="{% static 'core/img/logo3.png'%}" style="border-radius: 50%;" height="50px" alt="Community Plant"> 
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="/">Inicio</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Galeria De articulos
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                <li><a class="dropdown-item" href="{% url 'Caninos' %}">Articulos Caninos</a></li>
                <li><a class="dropdown-item" href="{% url 'Felinos' %}">Articulos Felinos</a></li>
                <li><a class="dropdown-item" href="{% url 'Avess' %}">Articulos de Aves</a></li>
              </ul>
              <li class="nav-item">
                <a class="nav-link" href="{% url 'Quienes Somos' %}">Quienes somos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" style="color: #FFFFFF;" aria-current="page" href="#">Catalogo</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="{% url 'seguimiento' %}">Seguimiento</a>
              </li>
            </li>
          </ul>
          <div style="margin-right: 1%;">
            <li class="d-flex ms-auto" style="color: #FFFFFF;" id="valorDolar" >
            </li>
            <li class="d-flex ms-auto" style="color: #FFFFFF;" id="fecha">
            </li>
          </div>
          <div>
            <li class="d-flex">
              <input type="button" value="Carrito: {{carrito|length}}" class="btn btn-light btn-outline-success" data-bs-dismiss="offcanvas" data-bs-toggle="modal" data-bs-target="#modalCarrito" name="carrito-btn">
            </li>
          </div>
          <div style="padding-left: 1vw;">
            {% if not esta_logueado %}
              <button class="btn btn-light btn-outline-success" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" >Iniciar Sesion</button>
            {% else %}
              <li class="d-flex nav-item dropdown">
                <a class="nav-link btn btn-light dropdown-toggle text-black" href="" id="userDropdownMenu" role="button" data-bs-toggle="dropdown" aria-expanded="false" >
                  Bienvenido {{ Usuario.username | capfirst }}
                </a>
                <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                  <li><a class="dropdown-item" href="{% url 'Perfil' %}">Mi perfil</a></li>
                  <li><a class="dropdown-item" href="{% url 'Revisar Solicitudes' %}">Revisar solicitudes</a></li>
                  <li><a class="dropdown-item"  id="logout">Cerrar Sesion</a></li>
                </ul>
              </li>
            {% endif %}
          </div>
        </div>
      </div>
    </nav>

                    <!-- Modal -->
                    <div class="modal fade " id="modalCarrito" data-bs-backdrop="false" data-bs-keyboard="false" tabindex="1" aria-labelledby="modalCarrito" aria-hidden="true" style="background-color: #00000097;">
                      <div class="modal-dialog modal-dialog-centered modal-lg">
                        <div class="modal-content">
                          <div class="text-center">
                            <div class="modal-header pt-0 pb-0 border-0">
                              <h1 class="modal-title pt-0 pb-0" id="tituloModalCarrito">Carrito</h1>
                              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">

                              {% if carrito|length == 0 %}
                                <p>El carrito esta vacio</p>
                              {% else %}
                                {% for producto,valor in carrito.items %}
                                <fieldset class="border p-2">
                                  <legend class="w-auto">{{producto}}</legend>
                                  <p class="m-0 p-0">Cantidad: {{valor.cantidad}}</p>
                                  <p class="m-0 p-0">Valor unitario: ${{valor.precio_unitario}}</p>
                                  <p class="m-0 p-0">Valor descuento: ${{valor.desc}}</p>
                                  <p class="m-0 p-0">Precio: ${% widthratio valor.cantidad 1 valor.precio_unitario|add:valor.desc %}</p>
                                  {% csrf_token %}
                                </fieldset >
                                {% endfor %}
                              {% endif %}
                            </div>
                            <div class="modal-footer">
                              <label for="cantidad">Codigo Descuento:</label>
                              <input class="input-sm" type="text" name="inputDes" id="inputDes" value='' max=" "min="" role="button">
                              <button type="button" class="btn btn-outline-warning" name="checkDescuento" id="checkDescuento">Checkear descuento</button>
                              <a href="/limpiarCarroto/" class="btn btn-secondary">Vaciar carrito</a>
                              {% if carrito|length == 0 %}
                              <a  class="btn btn-success disabled">Comprar</a>
                              {% else %}
                              <a href="/boleta/" target="_blank" class="btn btn-success">Comprar</a>
                              {% endif %}
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

    <!-- Galeria de fotos -->

    <!-- interiores -->
    <div><h5 class="display-3" style="margin-left: 1%;margin: top 0;">Catalogo</h5></div>

  
    <div style="margin-top: 1%;">
        <div class="container">
            <div class="row">
                {% for ca in cartas %}
                
                <div class="col d-flex justify-content-center"style="margin-left: auto; margin-right: auto; margin-bottom: 5%;">
                           
                <div class="card" style="width: 18rem;">
                        <div class="carousel-item active" data-bs-interval="2000">
                          <img src="{{ ca.imagenPlanta }}" class="d-block w-100">
                        </div>
                    <div class="card-body d-flex flex-column">
                      <h5 class="card-title">{{ca.nombrePlanta}}</h5>
                      <p class="card-text">{{ca.descripcionPlanta}}</p>
                      <p class="card-text">Precio: {{ca.precioPlanta}}</p>
                      <p class="card-text">Categoria: {{ca.categoria.nombreCategoria}}</p>
                      <p class="card-text">Stock disponible: {{ca.stockPlanta}}</p>
                        <!-- Inicio Boton Detalles-->
                        <div style="align-items: center;">
                          <div class="row">
                          <div class="col">
                            <div class="m-0 p-0">
                              <form class="row" name="comprar" action="catalogo.html" method="post" id="formComprar">
                                {% csrf_token %}
                                <div class="col-auto mb-3">
                                  <label for="cantidad">Cantidad a pedir:</label>
                                  <input class="form-control" type="number" name="cantidad" id="cantidad" value='1' max={{ca.stockPlanta}} min=1 role="button">
                                </div>
                                <input class="col-auto btn btn-success w-100" type="submit" value="Añadir al carrito" name="comprar-btn" id="comprar-btn" role="button">
                                <input class="btn btn-success" type="hidden" name="nombre" id="nombre" value='{{ca.nombrePlanta}}' role="button">
                               </form>
                            </div>
                          </div>
                        </div>      
                      </div> 
                    </div>
                    <!-- Fin Boton Detalles-->
                  </div>
                </div>
              </form>
            {% endfor %}
                </div>
            </div>
        </div>     
    </div>
  <div class="mt-auto" style="background-color: #5495ca7d; margin-top: 2%;">
    <footer class="container py-3">
      <div class="row">
        <div class="col-md">
          <center><a href="#"><img src="{% static 'core/img/logo3.png'%}" height="50px" alt="Littlepetshop" style="border-radius: 50%;"></a>
            <small><li class="d-block  text-muted">Duoc UC Sede Maipú</li></small>
            <small><li class="d-block  text-muted">Ingenieria informatica</li></small>
            <small><li class="d-block  text-muted">©2022 Derechos reservados</li></small>
          </center>
        </div>
        <div class="col-6 col-md">
          <h5>Acerca de</h5>
          <ul class="list-unstyled text-small">
            <li><a class="text-muted" href="https://github.com/Blap00/Experiencia4_Palma_hayashi_Poblete_Guimaraes">Link repositorio</a></li>
            <li><a class="text-muted" href="https://github.com/edobazz">Github Profesor</a></li>
            <li><a class="text-muted" href="https://www.duoc.cl/">Duoc UC</a></li>
            <li><a class="text-muted" href="contactanos.html">Contactanos</a></li>
          </ul>
        </div>
        <div class="col-6 col-md">
          <h5><img src="{% static 'core/img/iconoInsta.png'%}" width="30px" alt="iconoInsta"> Nuestras redes</h5>
          <ul class="list-unstyled text-small">
            <li><a class="text-muted" href="https://www.instagram.com/_little.pets.shop_?igshid=YmMyMTA2M2Y/">@_little.pets.shop</a></li>
            <li><a class="text-muted" href="https://www.instagram.com/_._Blap_._/">@_._Blap_._</a></li>
            <li><a class="text-muted" href="https://www.instagram.com/live_.itho._evil/">@live_.itho._evil</a></li>
            <li><a class="text-muted" href="https://www.instagram.com/vixo_guimaraes23/">@vixo_guimaraes23</a></li>
            <li><a class="text-muted" href="https://www.instagram.com/meiikaren/">@meiikaren</a></li>
          </ul>
        </div>
        
        <div class="col-6 col-md">
          <h5>Equipo (Github)</h5>
          <ul class="list-unstyled text-small">
            <li><a class="text-muted" href="https://github.com/Blap00">Fabian Palma</a></li>
            <li><a class="text-muted" href="https://github.com/ithoayashi">Hitoshen Hayashi</a></li>
            <li><a class="text-muted" href="https://github.com/vixo700">Vicente Guimaraes</a></li>
            <li><a class="text-muted" href="https://github.com/kapobleteg">Karen Poblete</a></li>
          </ul>
        </div>
      </div>
    </footer>
  </div>
  <!-- Fin de la pagina -->
    <!-- Mi js! -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" ></script>
    <script src="{% static 'core/js/apiDescuento.js'%}"> </script>    
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="{% static 'core/js/JsonConversion.js'%} "></script>
    <script src="{% static 'core/js/apiDescuento.js' %}"></script>
  </body>
</html>